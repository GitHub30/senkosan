(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{316:function(e,t,n){var content=n(444);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(42).default)("5175325a",content,!0,{sourceMap:!1})},317:function(e,t,n){var content=n(446);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(42).default)("36873827",content,!0,{sourceMap:!1})},359:function(e,t){},361:function(e,t){},394:function(e,t){},395:function(e,t){},437:function(e,t){},438:function(e,t){},439:function(e,t){},440:function(e,t){},442:function(e,t){},443:function(e,t,n){"use strict";var r=n(316);n.n(r).a},444:function(e,t,n){(e.exports=n(41)(!1)).push([e.i,".Dots{display:-webkit-box;display:flex}.Circle{margin:8px;border-radius:50%;width:16px;height:16px;will-change:transform;-webkit-transform:translateY(-8px);transform:translateY(-8px)}.Circle--blue{background:#4285f4;-webkit-animation:updown .8s ease-in-out -.75s infinite alternate;animation:updown .8s ease-in-out -.75s infinite alternate}.Circle--red{background:#db4437;-webkit-animation:updown .8s ease-in-out -.5s infinite alternate;animation:updown .8s ease-in-out -.5s infinite alternate}.Circle--yellow{background:#f4b400;-webkit-animation:updown .8s ease-in-out -.25s infinite alternate;animation:updown .8s ease-in-out -.25s infinite alternate}.Circle--green{background:#0f9d58;-webkit-animation:updown .8s ease-in-out infinite alternate;animation:updown .8s ease-in-out infinite alternate}@-webkit-keyframes updown{to{-webkit-transform:translateY(8px);transform:translateY(8px)}}@keyframes updown{to{-webkit-transform:translateY(8px);transform:translateY(8px)}}",""])},445:function(e,t,n){"use strict";var r=n(317);n.n(r).a},446:function(e,t,n){t=e.exports=n(41)(!1);var r=n(115)(n(447));t.push([e.i,".container{margin:0 auto;min-height:100vh;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;text-align:center;background:url("+r+");background-size:cover}.title{font-family:LightNovel,Quicksand,Source Sans Pro,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif;display:block;margin-bottom:32px;font-weight:300;color:#ffc107;text-stroke:1px #ffa000;-webkit-text-stroke:1px #ffa000;text-shadow:#000 0 0 5px;letter-spacing:1px}.subtitle{font-weight:700;font-size:32px;word-spacing:5px;font-family:LightNovel}.commands{text-align:left;white-space:nowrap}.links{padding-top:15px}.google-dots{margin-top:16px;margin-bottom:8px}.tl-button{margin-top:32px;font-family:LightNovel;color:#ffd54f;border-color:#ff6f00;text-stroke:1px #ff6f00;-webkit-text-stroke:1px #ff6f00}",""])},447:function(e,t,n){e.exports=n.p+"img/fd47d0a.jpg"},448:function(e,t,n){"use strict";n.r(t);n(10),n(13);var r=n(15),o=(n(45),n(7),n(355),n(60),n(16)),c=(n(354),n(441)),l=(n(443),n(46)),f={components:{Dots:Object(l.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"Dots"},[t("div",{staticClass:"Circle Circle--blue"}),this._v(" "),t("div",{staticClass:"Circle Circle--red"}),this._v(" "),t("div",{staticClass:"Circle Circle--yellow"}),this._v(" "),t("div",{staticClass:"Circle Circle--green"})])}],!1,null,null,null).exports},data:function(){return{transferRecognizer:null,newTransferRecognizer:null,ready:!1,transferLearning:{"うやん":0,"うゆん":0,"ただいま":0},audios:{"うやん":[],"うゆん":[],"ただいま":[]}}},mounted:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.audios["うやん"]=["uyan1.mp4","uyan2.mp4","uyan3.mp4"],this.audios["うゆん"]=["uyun1.mp4"],this.audios["ただいま"]=["tadaima1.mp4","tadaima2.mp4"],Object.values(this.audios).flat().forEach(this.prepareVideo),e.next=6,this.fetchModelAndListen();case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),methods:{start:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.a("BROWSER_FFT"),e.next=3,t.ensureModelLoaded();case 3:console.log(t.wordLabels()),t.listen(function(e){var n=Math.max.apply(Math,Object(r.a)(e.scores));console.log(t.wordLabels()[e.scores.indexOf(n)],n)},{includeSpectrogram:!0,probabilityThreshold:.75}),setTimeout(function(){return t.stopListening()},1e4);case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),tl:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){var t,n,r,o,l,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.a("BROWSER_FFT"),e.next=3,t.ensureModelLoaded();case 3:n=t.createTransfer("colors"),r=0,o=["うやん","うゆん","ただいま","_background_noise_"];case 6:if(!(r<o.length)){e.next=24;break}l=o[r],i=0;case 9:if(!(i<8)){e.next=21;break}if(console.log(l,i),"_background_noise_"!==l){e.next=16;break}return e.next=14,n.collectExample(l,{durationSec:10});case 14:e.next=18;break;case 16:return e.next=18,n.collectExample(l,{durationSec:2});case 18:i++,e.next=9;break;case 21:r++,e.next=6;break;case 24:return console.log(n.countExamples()),e.next=27,n.train({epochs:25,callback:{onEpochEnd:function(e,t){console.log("Epoch ".concat(e,": loss=").concat(t.loss,", accuracy=").concat(t.acc))}}});case 27:return this.downloadArtifacts(n.serializeExamples()),console.log("listening"),e.next=31,n.listen(function(e){console.log(e);for(var t=n.wordLabels(),i=0;i<t.length;++i)console.log("score for word '".concat(t[i],"' = ").concat(e.scores[i]))},{probabilityThreshold:.75});case 31:console.log(n.wordLabels()),setTimeout(function(){return n.stopListening()},1e5);case 33:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),downloadArtifacts:function(e){var t=document.createElement("a");t.download="".concat((new Date).toISOString().replace(/:/g,"."),".bin"),t.href=window.URL.createObjectURL(new Blob([e],{type:"application/octet-stream"})),t.click()},uploadArtifacts:function(e){var t=this,n=new FileReader;n.onload=function(e){t.prepare(e.target.result)},n.readAsArrayBuffer(e[0])},prepare:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.a("BROWSER_FFT"),e.next=3,n.ensureModelLoaded();case 3:this.transferRecognizer=n.createTransfer((new Date).toISOString().replace(/:/g,".")),!1,this.transferRecognizer.loadExamples(t,!1),console.log(this.transferRecognizer.countExamples()),this.train();case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),train:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.newTransferRecognizer.train({epochs:25,callback:{onEpochEnd:function(e,t){console.log("Epoch ".concat(e,": loss=").concat(t.loss,", accuracy=").concat(t.acc))}}});case 2:this.transferRecognizer=this.newTransferRecognizer,this.listen();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),collectExample:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(label,element){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return element.textContent="録音中",e.next=3,this.newTransferRecognizer.collectExample(label,{durationSec:2});case 3:element.textContent="録音する",this.transferLearning[label]++;case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),retrain:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.ready=!1,i=0;case 2:if(!(i<8)){e.next=9;break}return console.log("Collecting background noise",i),e.next=6,this.newTransferRecognizer.collectExample("_background_noise_",{durationSec:10});case 6:i++,e.next=2;break;case 9:console.log(this.newTransferRecognizer.countExamples()),console.log("retrain start"),this.train();case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),onTransferLearningClick:function(){console.log("stop recognizer"),this.transferRecognizer.stopListening(),this.newTransferRecognizer=this.transferRecognizer.createTransfer((new Date).toISOString().replace(/:/g,"."))},downloadModel:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.transferRecognizer){e.next=3;break}return console.error("Load model first."),e.abrupt("return");case 3:return console.log("Downloading transfer model: ".concat(this.transferRecognizer.name)),(t=document.createElement("a")).download="metadata.json",t.href=window.URL.createObjectURL(new Blob([JSON.stringify(this.transferRecognizer.getMetadata())],{type:"application/json"})),t.click(),e.next=10,this.transferRecognizer.model.save("downloads://model");case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),listen:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(this.transferRecognizer.wordLabels()),console.log("listening"),e.next=4,this.transferRecognizer.listen(function(e){console.log(e);var n=t.transferRecognizer.wordLabels(),o=Math.max.apply(Math,Object(r.a)(e.scores)),c=n[e.scores.indexOf(o)],l=t.audios[c];t.playVideo(l[Math.floor(Math.random()*l.length)]);for(var i=0;i<n.length;++i)console.log("score for word '".concat(n[i],"' = ").concat(e.scores[i]))},{probabilityThreshold:.75});case 4:console.log(this.transferRecognizer.wordLabels()),this.ready=!0;case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),fetchModelAndListen:function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=location.href.slice(0,location.href.lastIndexOf("/")+1),this.transferRecognizer=c.a("BROWSER_FFT",void 0,t+"model.json",t+"metadata.json"),window.transferRecognizer=this.transferRecognizer,e.next=5,this.transferRecognizer.ensureModelLoaded();case 5:this.listen();case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),prepareVideo:function(e){console.log("prepareing video");var video=document.createElement("video");video.id=e,video.src=e,video.controls=!1,video.hidden=!0,video.preload="auto",video.style.position="fixed",video.style.top="50%",video.style.left="50%",video.style.transform="translate(-50%, -50%)",document.body.appendChild(video)},playVideo:function(e){var video=document.getElementById(e);video.addEventListener("ended",function(){return video.hidden=!0},{once:!0}),video.hidden=!1,video.play()}}},d=(n(445),Object(l.a)(f,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("h1",{staticClass:"title"},[e._v("\n    仙狐さんAIスピーカーなのじゃ\n  ")]),e._v(" "),n("p",{staticClass:"subtitle"},[e._v("\n    以下のことばを話してほしいのじゃ\n  ")]),e._v(" "),e._m(0),e._v(" "),n("div",[n("dots",{staticClass:"google-dots"}),e._v(" "),e.ready?n("small",[e._v("お話ください")]):n("small",[e._v("学習中")])],1),e._v(" "),e.ready?n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-1",modifiers:{"modal-1":!0}}],staticClass:"tl-button",attrs:{variant:"outline-primary",size:"lg"},on:{click:e.onTransferLearningClick}},[e._v("\n    転移学習するのじゃ！\n  ")]):e._e(),e._v(" "),n("b-modal",{attrs:{id:"modal-1",title:"録音するのじゃ","ok-title":"転移学習するのじゃ"},on:{ok:e.retrain}},[n("ul",{staticClass:"subtitle commands"},[n("li",[e._v("\n        うやん("+e._s(e.transferLearning.うやん)+"/8)\n        "),n("b-button",{attrs:{variant:"outline-primary"},on:{click:function(t){return e.collectExample("うやん",t.target)}}},[e._v("\n          録音する\n        ")])],1),e._v(" "),n("li",[e._v("\n        うゆん("+e._s(e.transferLearning.うゆん)+"/8)\n        "),n("b-button",{attrs:{variant:"outline-primary"},on:{click:function(t){return e.collectExample("うゆん",t.target)}}},[e._v("\n          録音する\n        ")])],1),e._v(" "),n("li",[e._v("\n        ただいま("+e._s(e.transferLearning.ただいま)+"/8)\n        "),n("b-button",{attrs:{variant:"outline-primary"},on:{click:function(t){return e.collectExample("ただいま",t.target)}}},[e._v("\n          録音する\n        ")])],1)])])],1)},[function(){var e=this.$createElement,t=this._self._c||e;return t("ul",{staticClass:"subtitle commands"},[t("li",[this._v("うやん")]),this._v(" "),t("li",[this._v("うゆん")]),this._v(" "),t("li",[this._v("ただいま")])])}],!1,null,null,null));t.default=d.exports}}]);